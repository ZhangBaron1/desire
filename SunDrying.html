<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>幸运晒单</title>
    <link href="css/common.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="dist/mescroll.css">
    <link href="css/SunDrying.css" rel="stylesheet" type="text/css" />
    <script src="res/vue.min.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
  <div id="all-wrap" class="f-cb">
    <!--滑动区域-->
    <div id="mescroll" class="mescroll">
        <div class="top">
            <img class="banner" src="pic/indexBanner.png" alt="中奖还原池">
        </div>
        <div class="notice f-cb">
            <div class="ico">
                <svg t="1539768498702" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1790" xmlns:xlink="http://www.w3.org/1999/xlink" width="50" height="50"><defs><style type="text/css"></style></defs><path d="M240.736 632.504H122.52s-16.888-64.744-16.888-135.112 16.888-135.112 16.888-135.112h118.216" fill="#B2EDA6" p-id="1791"></path><path d="M240.736 648.504H122.52c-7.28 0-13.648-4.912-15.48-11.96-0.712-2.72-17.408-67.552-17.408-139.152s16.696-136.424 17.408-139.152a15.992 15.992 0 0 1 15.48-11.96h118.216a16 16 0 0 1 0 32h-105.52c-4.672 21.512-13.592 69.136-13.592 119.112 0 50.088 8.92 97.632 13.592 119.112h105.52a16 16 0 0 1 0 32zM730.52 591.768a24 24 0 0 1-17.088-40.856c0.648-0.68 21.232-22.6 21.232-53.512 0-31.4-20.904-53.184-21.112-53.4a23.984 23.984 0 0 1 0-33.936 23.984 23.984 0 0 1 33.936 0c1.44 1.432 35.176 35.768 35.176 87.336s-33.736 85.904-35.176 87.336a23.92 23.92 0 0 1-16.968 7.032zM865.648 690.288a24 24 0 0 1-15.096-42.672c2.752-2.256 61.448-51.656 61.448-150.216 0-99.896-60.752-149.664-61.36-150.152a24.008 24.008 0 0 1 29.984-37.488c3.24 2.592 79.376 64.92 79.376 187.632s-76.136 185.04-79.376 187.632a23.896 23.896 0 0 1-14.976 5.264z" fill="#3C663E" p-id="1792"></path><path d="M800.2 637.136a24 24 0 0 1-15.136-42.64c1.936-1.608 39.344-33.6 39.344-97.096 0-63.792-37.76-95.784-39.368-97.12a24.096 24.096 0 0 1-3.392-33.704 23.904 23.904 0 0 1 33.528-3.656c2.336 1.864 57.232 46.792 57.232 134.472s-54.888 132.608-57.232 134.472a23.808 23.808 0 0 1-14.976 5.272z" fill="#3C663E" p-id="1793"></path><path d="M128 871.904a381.336 81.488 0 1 0 762.672 0 381.336 81.488 0 1 0-762.672 0Z" fill="#B8CBCD" p-id="1794"></path><path d="M552.296 797.856l-320-167.264s-16.888-57.192-16.888-133.192c0-67.552 16.888-133.192 16.888-133.192l320-169.104" fill="#B2EDA6" p-id="1795"></path><path d="M552.288 813.856c-2.504 0-5.032-0.584-7.4-1.824l-320-167.264a16.016 16.016 0 0 1-7.936-9.648c-0.72-2.424-17.544-60.304-17.544-137.72 0-68.792 16.68-134.416 17.392-137.184a16 16 0 0 1 8.016-10.152l320-169.104a15.992 15.992 0 1 1 14.96 28.288L246.184 374.96c-4.128 18.16-14.784 70.08-14.784 122.432 0 58.52 10.376 105.696 14.536 122.272l313.76 164.008a16 16 0 0 1-7.408 30.184z" fill="#3C663E" p-id="1796"></path><path d="M656 497.4c0 167.896-39.696 304-88.672 304-48.968 0-88.664-136.104-88.664-304s35.48-304 84.448-304S656 329.504 656 497.4z" fill="#B2EDA6" p-id="1797"></path><path d="M567.328 817.4c-68.712 0-104.664-160.984-104.664-320 0-154.12 31.432-320 100.448-320 68.16 0 108.888 162.704 108.888 320 0 159.016-35.952 320-104.672 320z m-4.216-608c-28.584 0-68.448 109.568-68.448 288 0 175.808 43.04 288 72.664 288 29.632 0 72.672-112.192 72.672-288 0-173.136-46.28-288-76.888-288z" fill="#3C663E" p-id="1798"></path><path d="M235.936 428.504H122.52a24 24 0 1 1 0-48h107.36l261.256-140.688a24 24 0 0 1 22.76 42.264L247.312 425.64a24.032 24.032 0 0 1-11.376 2.864z" fill="#FFFFFF" p-id="1799"></path><path d="M494.056 749.032c-3.744 0-7.536-0.872-11.088-2.728l-252.88-132.016H122.52a24 24 0 1 1 0-48h113.456c3.864 0 7.68 0.936 11.104 2.72l258.104 134.736a24 24 0 0 1-11.128 45.288z" fill="#3C663E" p-id="1800"></path><path d="M494.072 421.4c41.976 0 76 34.024 76 76s-34.024 76-76 76" fill="#FFFFFF" p-id="1801"></path><path d="M494.072 589.4a16 16 0 0 1 0-32c33.088 0 60-26.912 60-60s-26.912-60-60-60a16 16 0 0 1 0-32c50.728 0 92 41.272 92 92s-41.264 92-92 92z" fill="#3C663E" p-id="1802"></path><path d="M565.848 825.4c-8.512 0-16.88-2.144-24.872-6.376L230.08 656.504H122.52a24 24 0 0 1-23.224-17.944c-0.72-2.768-17.664-68.552-17.664-141.168s16.944-138.4 17.664-141.168a24 24 0 0 1 23.224-17.944h107.464l302.24-159.72a57.928 57.928 0 0 1 11.872-6.024 51.248 51.248 0 0 1 17.536-3.152c75.92 0 116.888 168.992 116.888 328 0 157.984-35.256 328.016-112.672 328.016zM141.696 608.504h94.272c3.872 0 7.688 0.936 11.12 2.728l316.232 165.304c0.8 0.424 1.784 0.856 2.528 0.856 19.344 0 64.672-95.264 64.672-280 0-181.88-48.896-280-68.888-280a3.136 3.136 0 0 0-0.912 0.184l-0.224 0.08c-0.36 0.136-1.136 0.48-2.312 1.288a23.96 23.96 0 0 1-2.416 1.464L247.152 383.504a23.936 23.936 0 0 1-11.216 2.784H141.712c-4.776 23.288-12.08 66.272-12.08 111.112 0 44.984 7.296 87.872 12.064 111.104z" fill="#3C663E" p-id="1803"></path><path d="M565.848 817.4c-68.712 0-104.664-160.984-104.664-320 0-154.12 31.432-320 100.448-320 68.16 0 108.888 162.704 108.888 320 0 159.016-35.952 320-104.672 320z m-4.216-608c-28.584 0-68.448 109.568-68.448 288 0 175.808 43.04 288 72.664 288 29.632 0 72.672-112.192 72.672-288 0-173.136-46.28-288-76.888-288z" fill="#3C663E" p-id="1804"></path><path d="M232.296 630.592s-16.888-57.192-16.888-133.192c0-67.552 16.888-133.192 16.888-133.192" fill="#B2EDA6" p-id="1805"></path><path d="M232.288 646.592a16 16 0 0 1-15.336-11.472c-0.72-2.424-17.544-60.304-17.544-137.72 0-68.792 16.68-134.416 17.392-137.184a16 16 0 1 1 30.992 7.976c-0.168 0.64-16.384 64.584-16.384 129.208 0 72.84 16.072 128.112 16.232 128.664a15.992 15.992 0 0 1-15.352 20.528z" fill="#3C663E" p-id="1806"></path></svg>
            </div>
            <div class="message-warp">
                <ul class="text" id="notice-ul">
                <li>我真的中奖了么。。。。</li>
                <li>是的噶</li>
                <li>付电话费的</li>
                <li>问题安德森公司的干活</li>
                <li>熬夜人缘好</li>
                <li>二娃也</li>
                <li>二娃也</li><li>二娃也</li><li>二娃也</li>
                <li>二娃也</li>
                <li>二娃也</li><li>二娃也</li>
                <li>二娃也</li>
                <li>二娃也</li>
                <li>二娃也</li>
                <li>问题安德森公司的干活</li>
                <li>问题安德森公司的干活</li>
                <li>问题安德森公司的干活</li>
                <li>问题安德森公司的干活</li><li>问题安德森公司的干活</li>
                <li>问题安德森公司的干活</li>
                <li>问题安德森公司的干活</li>
            </ul>
            </div>
        </div>
        <!--展示上拉加载的数据列表-->
        <ul id="dataList" class="data-list" v-cloak>
            <li v-for="pd in pdlist" class="item f-cb">
                <img class="pd-img" :src="pd.pdImg"/>
                <div class="info">
                    <p class="pd-name">{{pd.pdName}}</p>
                    <p class="pd-price">{{pd.pdPrice}} 元</p>
                    <p class="pd-sold">已售{{pd.pdSold}}件</p>
                </div>
            </li>
        </ul>
    </div>
    <div class="fixFooter">
        <nav>
            <p i="0" @click="changeTab(0)" :class="{'active':pdType==0}">最新</p>
            <p i="1" @click="changeTab(1)" :class="{'active':pdType==1}">热门</p>
            <p i="2" @click="changeTab(2)" :class="{'active':pdType==2}">发布</p>
            <p i="3" @click="changeTab(3)" :class="{'active':pdType==3}">翻牌</p>
            <p i="4" @click="changeTab(4)" :class="{'active':pdType==4}">活动</p>
        </nav>
    </div>
  </div>

    <script src="dist/mescroll.js" type="text/javascript" charset="utf-8"></script>
    <!--模拟的数据-->
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">

        //创建vue对象
        var vm = new Vue({
            el: "#all-wrap",
            data: {
                mescroll: null,
                pdType:0,
                pdlist: []
            },
            mounted: function() {
                //创建MeScroll对象,down可以不用配置,因为内部已默认开启下拉刷新,重置列表数据为第一页
                //解析: 下拉回调默认调用mescroll.resetUpScroll(); 而resetUpScroll会将page.num=1,再执行up.callback,从而实现刷新列表数据为第一页;
                var self = this;
                self.mescroll = new MeScroll("mescroll", { //请至少在vue的mounted生命周期初始化mescroll,以确保您配置的id能够被找到
                    up: {
                        callback: self.upCallback, //上拉回调
                        lazyLoad:{
                            use:true//启动懒加载
                        },
                        isBounce: false, //此处禁止ios回弹,解析(务必认真阅读,特别是最后一点): http://www.mescroll.com/qa.html#q10
                        //page:{size:8}, //可配置每页8条数据,默认10
                        toTop:{ //配置回到顶部按钮
                            src : "res/img/mescroll-totop.png", //默认滚动到1000px显示,可配置offset修改
                            //html: null, //html标签内容,默认null; 如果同时设置了src,则优先取src
                            //offset : 1000
                        },
                        empty:{ //配置列表无任何数据的提示
                            warpId:"dataList",
                            icon : "res/img/mescroll-empty.png" ,
//						  	tip : "亲,暂无相关数据哦~" ,
//						  	btntext : "去逛逛 >" ,
//						  	btnClick : function() {
//						  		alert("点击了去逛逛按钮");
//						  	}
                        },
                    },
                    down:{
                        hardwareClass: "mescroll-hardware"
                    }
                });

            },
            methods: {
                //切换菜单
                changeTab:function(pdType){
                    console.log("iam here ..a.fds",pdType);
                    if(this.pdType!=pdType){
                        this.pdType=pdType;
                        //重置列表数据
                        this.pdlist = [];//先置空列表,可显示上拉的加载进度
                        this.mescroll.resetUpScroll();
                        //隐藏回到顶部按钮
                        this.mescroll.hideTopBtn();

                        //这里为了模拟加载中的占位图,延长了懒加载的时间间隔
                        if(pdType==2){
                            this.mescroll.optUp.lazyLoad.delay=5000;
                        }else{
                            this.mescroll.optUp.lazyLoad.delay=300;//默认 300ms
                        }
                    }
                },
                //上拉回调 page = {num:1, size:10}; num:当前页 ,默认从1开始; size:每页数据条数,默认10
                upCallback: function(page) {
                    //联网加载数据
                    var self = this;
                    getListDataFromNet(self.pdType, page.num, page.size, function(curPageData) {
                        //curPageData=[]; //打开本行注释,可演示列表无任何数据empty的配置

                        //如果是第一页需手动制空列表 (代替clearId和clearEmptyId的配置)
                        if(page.num == 1) self.pdlist = [];

                        //更新列表数据
                        self.pdlist = self.pdlist.concat(curPageData);

                        //联网成功的回调,隐藏下拉刷新和上拉加载的状态;
                        //mescroll会根据传的参数,自动判断列表如果无任何数据,则提示空;列表无下一页数据,则提示无更多数据;
                        console.log("page.num="+page.num+", page.size="+page.size+", curPageData.length="+curPageData.length+", self.pdlist.length==" + self.pdlist.length);

                        //方法一(推荐): 后台接口有返回列表的总页数 totalPage
                        //self.mescroll.endByPage(curPageData.length, totalPage); //必传参数(当前页的数据个数, 总页数)

                        //方法二(推荐): 后台接口有返回列表的总数据量 totalSize
                        //self.mescroll.endBySize(curPageData.length, totalSize); //必传参数(当前页的数据个数, 总数据量)

                        //方法三(推荐): 您有其他方式知道是否有下一页 hasNext
                        //self.mescroll.endSuccess(curPageData.length, hasNext); //必传参数(当前页的数据个数, 是否有下一页true/false)

                        //方法四 (不推荐),会存在一个小问题:比如列表共有20条数据,每页加载10条,共2页.如果只根据当前页的数据个数判断,则需翻到第三页才会知道无更多数据,如果传了hasNext,则翻到第二页即可显示无更多数据.
                        self.mescroll.endSuccess(curPageData.length);

                        //提示:curPageData.length必传的原因:
                        // 1.判断是否有下一页的首要依据: 当传的值小于page.size时,则一定会认为无更多数据.
                        // 2.比传入的totalPage, totalSize, hasNext具有更高的判断优先级
                        // 3.使配置的noMoreSize生效

                    }, function() {
                        //联网失败的回调,隐藏下拉刷新和上拉加载的状态;
                        self.mescroll.endErr();
                    });
                },
            },
        });

        function getListDataFromNet(pdType,pageNum,pageSize,successCallback,errorCallback) {
            //延时一秒,模拟联网
            setTimeout(function () {
                $.ajax({
                    type: 'GET',
                    url: 'res/pdlist1.json',
//		            url: '../res/pdlist1.json?pdType='+pdType+'&num='+pageNum+'&size='+pageSize,
                    dataType: 'json',
                    success: function(data){
                        var listData=[];
                        //模拟分页数据
                        for (var i = (pageNum-1)*pageSize; i < pageNum*pageSize; i++) {
                            if(i==data.length) break;
                            listData.push(data[i]);
                        }
                        //回调
                        successCallback(listData);
                    },
                    error: errorCallback
                });
            },1000)
        }
        (function(){
            var oUl = document.getElementById('notice-ul');
            oUl.innerHTML +=　oUl.innerHTML;
            var time = null;
            var speed = -2;

            function autoplay(){
                clearInterval(time);
                time = setInterval(function() {
                    if(oUl.offsetLeft<-(oUl.offsetWidth/2)){
                        oUl.style.left = 0;
                    }
                    oUl.style.left = oUl.offsetLeft+speed+'px';
                },100);
            }
            setTimeout(autoplay,1000);
        })();
    </script>
</body>
</html>